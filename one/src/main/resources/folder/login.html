<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Spring Security AJAX Login (Tech-Minimal Dark)</title>-->
<!--    <script src="https://cdn.tailwindcss.com"></script>-->
<!--    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>-->
<!--    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>-->

<!--    <script>-->
<!--        tailwind.config = {-->
<!--            theme: {-->
<!--                extend: {-->
<!--                    colors: {-->
<!--                        'primary-blue': '#4c51bf', // Custom Blue-->
<!--                    },-->
<!--                    // Focus ring ko zyada prominent aur clean banane ke liye-->
<!--                    boxShadow: {-->
<!--                        'focus-blue': '0 0 0 3px rgba(76, 81, 191, 0.5)',-->
<!--                    }-->
<!--                }-->
<!--            }-->
<!--        }-->
<!--    </script>-->
<!--</head>-->

<!--<link rel="stylesheet" href="/css/login.css">-->
<!--<body class="flex items-center justify-center min-h-screen p-4 bg-slate-900">-->

<!--<div id="message-box" class="hidden fixed top-4 mx-auto w-full max-w-sm text-center py-3 px-4 rounded-lg text-white font-medium shadow-xl transition-opacity duration-500 opacity-0 z-50">-->
<!--</div>-->

<!--<section id="login-section"-->
<!--         class="relative w-full max-w-sm md:max-w-md-->
<!--               bg-gray-800 text-gray-100 rounded-xl-->
<!--               p-8 md:p-10 shadow-2xl transition-all duration-500 border border-gray-700-->
<!--               transform hover:scale-[1.02] duration-500 ease-in-out"> <form id="login-form" method="POST" action="/req/login">-->

<!--    <h1 class="text-3xl font-extrabold text-white text-center mb-10 tracking-wider"> ACCESS PORTAL-->
<!--    </h1>-->

<!--    <div class="input-group mb-6 relative">-->
<!--        <ion-icon name="person-outline" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></ion-icon>-->
<!--        <input name="email" id="email" type="email" placeholder=" " required autocomplete="username"-->
<!--               class="w-full pl-10 pr-4 py-3 bg-gray-700 rounded-lg border border-gray-600-->
<!--                          focus:border-primary-blue focus:ring-1 focus:ring-primary-blue transition duration-200"-->
<!--        />-->
<!--        <label for="email" class="absolute left-10 top-3 text-gray-400 transition-all duration-200 pointer-events-none">Email Address</label>-->
<!--    </div>-->
<!--    <div class="input-group mb-4 relative">-->
<!--        <ion-icon name="lock-closed-outline" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></ion-icon>-->
<!--        <input name="password" type="password" id="password" placeholder=" " required autocomplete="current-password"-->
<!--               class="w-full pl-10 pr-4 py-3 bg-gray-700 rounded-lg border border-gray-600-->
<!--                          focus:border-primary-blue focus:ring-1 focus:ring-primary-blue transition duration-200"-->
<!--        />-->
<!--        <label for="password" class="absolute left-10 top-3 text-gray-400 transition-all duration-200 pointer-events-none">Password</label>-->
<!--    </div>-->

<!--    <div class="flex justify-between items-center text-sm mt-4 mb-8">-->
<!--        <div class="text-xs text-gray-500">Secure Login Required</div> <a href="#" class="text-primary-blue hover:text-white transition-colors duration-300 font-medium">-->
<!--        Forgot Password?-->
<!--    </a>-->
<!--    </div>-->

<!--    <button id="login-button" type="submit"-->
<!--            class="w-full h-12 rounded-lg bg-primary-blue text-white font-extrabold text-lg-->
<!--                       shadow-xl hover:shadow-primary-blue/30 active:scale-[0.98]-->
<!--                       transition-all duration-300 ease-in-out-->
<!--                       disabled:bg-gray-600 disabled:shadow-none disabled:cursor-not-allowed"-->
<!--    >-->
<!--        Secure Log In-->
<!--    </button>-->

<!--    <div class="text-center text-sm text-gray-400 mt-8">-->
<!--        <p>Don't have an account?-->
<!--            <a href="templates/login.html" id="signup"-->
<!--               class="font-bold text-primary-blue hover:underline transition-colors duration-300 ml-1">-->
<!--                Sign Up-->
<!--            </a>-->
<!--        </p>-->
<!--    </div>-->

<!--    <div class="text-center text-xs mt-3">-->
<!--        <a href="/journal.html"-->
<!--           class="text-gray-500 hover:text-white transition-colors duration-300 cursor-pointer border-b border-gray-500 hover:border-white">-->
<!--            Proceed without Login-->
<!--        </a>-->
<!--    </div>-->

<!--</form>-->
<!--</section>-->

<!--<script>-->
<!--    // ... (Your previous, correct JavaScript fetch logic here) ...-->
<!--    // Note: Use the 'Authenticating...' text in the JS for better feedback.-->

<!--    // Constants for better code readability-->
<!--    const LOGIN_URL = '/req/login';-->
<!--    const SUCCESS_URL_PARTIAL = '/home';-->
<!--    const LOGIN_FAILURE_URL_PARTIAL = '/login';-->

<!--    // Custom Message Box function (Same as before)-->
<!--    const showMessageBox = (message, color) => {-->
<!--        // ... (function body remains the same) ...-->
<!--        const messageBox = document.getElementById('message-box');-->
<!--        messageBox.textContent = message;-->

<!--        messageBox.classList.remove('bg-red-500', 'bg-green-500', 'hidden');-->

<!--        if (color === 'red') {-->
<!--            messageBox.classList.add('bg-red-500');-->
<!--        } else if (color === 'green') {-->
<!--            messageBox.classList.add('bg-green-500');-->
<!--        }-->

<!--        messageBox.classList.remove('opacity-0');-->
<!--        messageBox.classList.add('opacity-100');-->

<!--        setTimeout(() => {-->
<!--            messageBox.classList.remove('opacity-100');-->
<!--            messageBox.classList.add('opacity-0');-->
<!--            setTimeout(() => messageBox.classList.add('hidden'), 500);-->
<!--        }, 3000);-->
<!--    };-->


<!--    // Main Event Listener for Form Submission-->
<!--    const loginForm = document.getElementById('login-form');-->
<!--    const loginButton = document.getElementById('login-button');-->

<!--    loginForm.addEventListener('submit', async (event) => {-->
<!--        event.preventDefault();-->

<!--        const email = document.getElementById('email').value;-->
<!--        const password = document.getElementById('password').value;-->

<!--        // Validation Check-->
<!--        if (!email.trim() || !password.trim()) {-->
<!--            showMessageBox("Enter email and password.", 'red');-->
<!--            return;-->
<!--        }-->

<!--        // UI Feedback during API call-->
<!--        loginButton.textContent = 'Authenticating...';-->
<!--        loginButton.disabled = true;-->

<!--        // Credentials encoding-->
<!--        const formData = new URLSearchParams();-->
<!--        formData.append('username', email);-->
<!--        formData.append('password', password);-->

<!--        try {-->
<!--            const response = await fetch(LOGIN_URL, {-->
<!--                method: 'POST',-->
<!--                headers: {-->
<!--                    'Content-Type': 'application/x-www-form-urlencoded'-->
<!--                },-->
<!--                body: formData-->
<!--            });-->

<!--            // UI feedback reset-->
<!--            loginButton.textContent = 'Log In';-->
<!--            loginButton.disabled = false;-->

<!--            // Handle Spring Security Redirect-->
<!--            if (response.redirected) {-->
<!--                if (response.url.includes(SUCCESS_URL_PARTIAL)) {-->
<!--                    showMessageBox('Login Successful! Redirecting...', 'green');-->
<!--                    window.location.href = response.url;-->
<!--                    return;-->
<!--                } else if (response.url.includes(LOGIN_FAILURE_URL_PARTIAL)) {-->
<!--                    showMessageBox('Login Failed: Invalid Email or Password.', 'red');-->
<!--                    return;-->
<!--                }-->
<!--            }-->

<!--            // Handle unexpected status codes-->
<!--            if (response.status === 401 || response.status === 403) {-->
<!--                showMessageBox('Login Failed: Unauthorized access or expired session.', 'red');-->
<!--            } else if (response.status !== 200) {-->
<!--                showMessageBox(`Error: Server responded with status ${response.status}.`, 'red');-->
<!--            } else {-->
<!--                showMessageBox('Login process ambiguous. Please check server logs.', 'red');-->
<!--            }-->

<!--        } catch (error) {-->
<!--            console.error('Fetch Error:', error);-->
<!--            showMessageBox('Network error. Server se connection nahi ho paya.', 'red');-->
<!--            loginButton.textContent = 'Log In';-->
<!--            loginButton.disabled = false;-->
<!--        }-->
<!--    });-->

<!--    document.getElementById("signup").addEventListener("click", () => {-->
<!--        window.location.href = "/register";-->
<!--    });-->



<!--</script>-->
<!--</body>-->
<!--</html>-->



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Security AJAX Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 'primary-blue': '#4c51bf' },
                    boxShadow: { 'focus-blue': '0 0 0 3px rgba(76, 81, 191, 0.5)' }
                }
            }
        }
    </script>
</head>
<link rel="stylesheet" href="/extras/css1/login.css">
<body class="flex items-center justify-center min-h-screen p-4 bg-slate-900">

<div id="message-box" class="hidden fixed top-4 mx-auto w-full max-w-sm text-center py-3 px-4 rounded-lg text-white font-medium shadow-xl transition-opacity duration-500 opacity-0 z-50"></div>

<section class="relative w-full max-w-sm md:max-w-md bg-gray-800 text-gray-100 rounded-xl p-8 md:p-10 shadow-2xl transition-all duration-500 border border-gray-700 transform hover:scale-[1.02]">
    <form id="login-form" method="POST" action="/req/login">
        <h1 class="text-3xl font-extrabold text-white text-center mb-10 tracking-wider">ACCESS PORTAL</h1>

        <div class="input-group mb-6 relative">
            <ion-icon name="person-outline" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></ion-icon>
            <input name="email" id="email" type="email" placeholder=" " required autocomplete="username"
                   class="w-full pl-10 pr-4 py-3 bg-gray-700 rounded-lg border border-gray-600 focus:border-primary-blue focus:ring-1 focus:ring-primary-blue transition duration-200"/>
            <label for="email" class="absolute left-10 top-3 text-gray-400 transition-all duration-200 pointer-events-none">Email Address</label>
        </div>

        <div class="input-group mb-4 relative">
            <ion-icon name="lock-closed-outline" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></ion-icon>
            <input name="password" id="password" type="password" placeholder=" " required autocomplete="current-password"
                   class="w-full pl-10 pr-4 py-3 bg-gray-700 rounded-lg border border-gray-600 focus:border-primary-blue focus:ring-1 focus:ring-primary-blue transition duration-200"/>
            <label for="password" class="absolute left-10 top-3 text-gray-400 transition-all duration-200 pointer-events-none">Password</label>
        </div>

        <div class="flex justify-between items-center text-sm mt-4 mb-8">
            <div class="text-xs text-gray-500">Secure Login Required</div>
            <a href="#" class="text-primary-blue hover:text-white transition-colors duration-300 font-medium">Forgot Password?</a>
        </div>

        <button id="login-button" type="submit"
                class="w-full h-12 rounded-lg bg-primary-blue text-white font-extrabold text-lg shadow-xl hover:shadow-primary-blue/30 active:scale-[0.98] transition-all duration-300 ease-in-out disabled:bg-gray-600 disabled:shadow-none disabled:cursor-not-allowed">
            Secure Log In
        </button>

        <div class="text-center text-sm text-gray-400 mt-8">
            <p>Don't have an account?
                <a href="/register" id="signup-link" class="font-bold text-primary-blue hover:underline transition-colors duration-300 ml-1">
                    Sign Up
                </a>
            </p>
        </div>

        <div class="text-center text-xs mt-3">
            <a href="/home" class="text-gray-500 hover:text-white transition-colors duration-300 cursor-pointer border-b border-gray-500 hover:border-white">
                Proceed without Login
            </a>
        </div>
    </form>
</section>

<script>
    const showMessageBox = (message, color) => {
        const box = document.getElementById('message-box');
        box.textContent = message;
        box.classList.remove('bg-red-500', 'bg-green-500', 'hidden');
        box.classList.add(color==='red'?'bg-red-500':'bg-green-500');
        box.classList.remove('opacity-0'); box.classList.add('opacity-100');
        setTimeout(()=>{box.classList.remove('opacity-100');box.classList.add('opacity-0');setTimeout(()=>box.classList.add('hidden'),500)},3000);
    };

    const loginForm = document.getElementById('login-form');
    const loginButton = document.getElementById('login-button');
    loginForm.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        if(!email.trim() || !password.trim()){showMessageBox("Enter email and password.", 'red'); return;}
        loginButton.textContent='Authenticating...'; loginButton.disabled=true;

        const formData = new URLSearchParams();
        formData.append('username', email);
        formData.append('password', password);

        try {
            const response = await fetch('/req/login',{
                method:'POST',
                headers:{'Content-Type':'application/x-www-form-urlencoded'},
                body: formData
            });
            loginButton.textContent='Secure Log In'; loginButton.disabled=false;

            if(response.redirected){
                if(response.url.includes('/home')){ showMessageBox('Login Successful! Redirecting...', 'green'); window.location.href=response.url; return;}
                if(response.url.includes('/login')){ showMessageBox('Login Failed: Invalid Email or Password.', 'red'); return;}
            }
            if(response.status===401||response.status===403){showMessageBox('Login Failed: Unauthorized.', 'red');}
            else if(response.status!==200){showMessageBox(`Error: Server ${response.status}`, 'red');}
        }catch(err){console.error(err); showMessageBox('Network error.', 'red'); loginButton.textContent='Secure Log In'; loginButton.disabled=false;}
    });

    // Sign Up redirect (AJAX not needed, simple redirect)
    document.getElementById('signup-link').addEventListener('click', e=>{
        e.preventDefault();
        window.location.href='/req/register'; // Spring Security public register page
    });
</script>

</body>
</html>
